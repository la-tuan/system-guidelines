## 構成管理

- AWSインフラに関して、CloudFormationやTerraformなどで構成管理されていること。
- 各インスタンスに関して、ChefやAnsibleなどで構成管理されていること。

## セキュリティグループ/ファイヤーウォール

- 原則として、すべてのトラフィックを拒否し必要なトラフィックのみ許可となっていること。
- RDSやElasticacheなど、インターネットから直接アクセスされるべきでないものに関しては、インターネットからアクセス出来ないよう設定されていること。

## 構成全般

- 冗長化を考慮した構成となっていること(Multi-AZやホットスタンバイであること)
- 冗長化された同じ目的のサーバー間において、各種パッケージのバージョンが統一されていること。
- 必要な場合を除き、Redis/MemcacheおよびMySQLなどのミドルウェアはマネージドサービスを使用していること
- 障害などによりサービス提供できない場合、自動的にSorryページの表示が行われるようになっていること。
- インスタンス数の増加に備え、必要であれば予め上限緩和申請を行うこと

## ネットワーク

- VPCは他サービスと分離していること
- IPアドレスやサブネットなど、構築後の構成変更に柔軟に対応できるよう余裕を持った設計を行うこと
    - VPCを /16 で設定し、各サブネットは /24 でCIDRを切るなど

## OSアカウント設定

- SSHログインに関しては、踏み台インスタンスを経由してSSH接続を行う構成となっていること。
- OSアカウントは個人ユーザごとに発行されており、やむを得ない場合を除き共通ユーザの使用はされていないこと。
- バッチなどに関しては、専用ユーザを作成した上でプログラム本体やディレクトリに適切な権限が付与されていること。
- 外部連携用ユーザに関しては、専用ユーザを作成した上でディレクトリなどに適切な権限が付与されていること。

## OS基本設定

- ulimitによるシステムリソース制限の設定は完了しているか。
- 正しい文字コードが設定されているか。(※原則、UTF-8)
- NTPサーバーとの時刻同期の設定がされているか。
- タイムゾーンの設定がJST(日本標準時)になっていること

## 監視設定

- CPU, LoadAverage,メモリ使用率, Disk使用率, KVSのキャッシュヒット率など必須の監視を行っていること。
- サービス提供に必要なプロセスの洗い出しと監視を行っていること。
- ELBを使用している場合、UnHealthyHostCountやレイテンシー、5xxエラーレートなどの監視を行うこと。
- Webサイトの場合、レスポンス監視を行っていること。

## ログ

- ELBやCloudFrontのログを保存していること
- EC2インスタンス内のアクセスログ/アプリケーションログに関しても、出力される設定となっていること
- ログは原則6ヶ月以上保持し、ログローテーションを日次で行うこと。
- アプリケーションのログは、商用環境ではerror以上の出力とすること (詳細はAppDeveloperGuideline.mdを)

## キャッシュ

- 各ページごとのCache-Controlが想定(設計)どおりに設定されているか。

## データベース

- Timezoneや文字コードが適切に設定されていること
- RDSを使用する際、ディスク容量に関して適切にサイジングしていること。

## バックアップ

- データベースのバックアップに関して、毎日取得し7日以上保持すること
- バックアップを取得する時間帯はサービス影響のない時間とすること

## ロードバランサ
- 同一サーバーでのセッションが維持されていること。(スティッキーセッションもしくはDB,KVSにセッションを保持させる)
- 必要な場合を除き、ClassicLoadBalancerではなくApplicationLoadBalancerを使用すること
- 各ELBが所属するサブネットは、Publicサブネットとなっていること。

## メール送信設定
- ユーザー向けのメール送信機能がある場合、SPFレコードが登録されていること。SPFレコードが正しく設定されているかはdigコマンドで確認すること。（SPFレコードを設定していないと迷惑メールに振り分けられる可能性が高くなる）
- 必要な場合を除き、AWS環境でのメール送信は SES を使用すること

