## 構成管理

- AWSインフラに関して、CloudFormationやTerraformなどで構成管理されていること。
- 各インスタンスに関して、ChefやAnsibleなどで構成管理されていること。

## OSアカウント設定
- OSアカウントは個人ユーザごとに発行されており、やむを得ない場合を除き共通ユーザの使用はされていないこと。
- バッチなどに関しては、専用ユーザを作成した上でプログラム本体やディレクトリに適切な権限が付与されていること。
- 外部連携用ユーザに関しては、専用ユーザを作成した上でディレクトリなどに適切な権限が付与されていること。

## SELinuxの無効化
- SELinux無効化されているか。(SELINUX=disabled)

## システムリソース制限の設定(ulimit)
- ulimitによるシステムリソース制限の設定は完了しているか。

## NATの設定(ネットワークアドレス変換)
- iptablesによるNAT(ネットワークアドレス変換)、パケットフィルタリングの設定は完了しているか。

## 文字コード設定
- 正しい文字コードが設定されているか。(※原則、UTF-8)

## 時刻同期(NTP)
- NTPサーバーとの時刻同期の設定がされているか。

## タイムゾーン
- タイムゾーンの設定がJST(日本標準時)になっているか。

## プロセスの自動起動(Runレベルの設定)
- chkconfigによるサーバー起動時に自動起動するプロセスの設定(Runレベルの設定)は完了しているか。

## パッケージのバージョン
- 冗長化された同じ目的のサーバー間において、各種パッケージのバージョンが統一されているか。

## メモリサイズ(上限)の設定
- 環境に合わせてPHPの最適なメモリサイズ(上限)の設定を実施しているか。(php.ini)(※CentOSの場合、デフォルトで128MB)

## 拡張モジュールのインストール
- 必要なライブラリ、エクステンション(pecl pear composer)のインストール、設定は完了しているか。(※Opcache、もしくは、APCは適用しておくこと)

## 起動ユーザ
- Apacheの実行ユーザは原則「apache」を使用すること。

## 各種パラメータチューニング
- 性能試験の結果を踏まえ、以下のパラメータのチューニングが完了しているか。

## virtualhostの設定
- virtualhostの設定が完了しているか。

## ログローテーション設定
- access_log、error_logのローテーションの設定が完了しているか。(※原則日次ローテーション)

## deflate設定(帯域対策)
- deflate設定(gzip)が実施されているか。

## ファイル一覧表示の防止設定(-Indexes)
- ブラウザでディレクトリ直アクセスされた場合にファイルの一覧が表示されないように設定されているか。(「Options Indexes FollowSymLinks」のIndexesの前にハイフンを付ける)

## キャッシュ制御の設定(Cache-Control)
- 各ページごとのCache-Controlが想定(設計)どおりに設定されているか。

## 設定値の稼働確認
- 上記の設定項目(下記)について、設定ファイルだけではなく、ディベロッパーツールなどでヘッダーを確認すること。

## ユーザー/ロールの設定
- 必要なユーザー、ロールの作成は完了しているか。(※rootは利用しないこと)

## テーブルサイズの設定
- テーブルの最大サイズは最適な設定値にチューニングされているか。

## バイナリログの設定
- バイナリログに関するパラメータ設定は完了しているか。(ログ出力先、保管日数、1ファイルあたりの最大サイズなど)

## 各種パラメータ設定
- 環境に合わせた最適なパラメータが設定されているか。

## レプリケーションの設定
- レプリケーション設定がなされているか。(※AWSの場合は、Multi-AZ配置)

## 文字コード設定
- 正しい文字コードが設定されているか。(※原則、UTF-8)

## MVCフレームワークその①
- フレームワーク本体が配置されているか。

## MVCフレームワークその②
- yiiのruntimeのパーミッションが正しく設定されているか。

## MVCフレームワークその③
- 各種設定が商用環境(プロダクション)用の設定になっているか。

## テンプレートエンジン(Smarty)
- Smartyのキャッシュディレクトリのパーミッションが正しく設定されているか。

## ログ設定①
- シスログを使用し、アプリケーションログのruntimeへの出力は避けること。

## ログ設定②
- ログの出力レベルは、ログ出力によるパフォーマンス劣化を考慮し、「infoレベルのログは出力しない」設定にすること。

## ログ設定③
- ログローテーションの設定が完了しているか。(※原則日次ローテーション)

## ロードバランサの設定その①
- LBに組み込まれ、かつ、アクセスが可能なこと。(※AWSの場合はELB)(※アクセスログを確認すること)

## ロードバランサの設定その②
- 同一サーバーでのセッションが維持されていること。(※DB、KVSにセッションIDを保持させる方法を推奨)

## 起動ポートの確認
- 最終的に80(http)/443(https)のどちらで稼働するか確認をすること。(※LBでSSL設定する場合は80(http)で)

## キャッシュサーバ
- 総合テストを実施する環境のキャッシュサーバが商用環境と同じであることを確認すること

## Disaster Recovery(災害対策)
- アクティブ機が落ちた時の対処方法が確立され、対応の手順が整理されていること。

## メール送信設定
- ユーザー向けのメール送信機能がある場合、SPFレコードが登録されていること。SPFレコードが正しく設定されているかはdigコマンドで確認すること。（SPFレコードを設定していないと迷惑メールに振り分けられる可能性が高くなる）

## テスト結果 全般
- 各テストで検知した障害の改修が完了しているか。未対応の障害が残っている場合、リリース後の暫定対応方法、および、恒久対応の完了予定日が明確になっているか。

## 対応デバイス・OS・ブラウザ
- 対応デバイス、OS、ブラウザでの動作確認がすべて完了しているか。(表示崩れなど)

## イレギュラーケース
- I/F機能の場合、対象データがゼロ件の場合の仕様について、対向システムと整合し、連携テストが完了しているか。

## 検証不可エラーケース
- 人為的に発生させることができないエラーケースについて、代替手段での検証、品質担保を実施したか。

## 情報漏洩防止
- 情報漏洩リスクがあるメール送信機能(メール本文に個人情報が含まれるなど)については、必ず送信対象が複数のケースでテストを実施し、以下の事象が発生していないことを確認すること。

## 性能試験
- 「性能検証観点」シートの観点で、性能要件を満たすテスト結果が得られているか。

## 脆弱性試験
- 脆弱性診断ツールでクリティカルな脆弱性はすべて対処されていること

## auMarket利用区分
- auMarketの利用申請区分が適切な区分になっているか。

## 実施タイミング
- オンライン、ジョブ、他システム連携などを考慮した上でリリース実施タイミングが決定されているか。

## 実施担当者
- リリース担当者は決まっているか。また、深夜のリリース、土日のリリースの場合、担当メンバのシフトを考慮しているか。

## アラート連絡先
- リリース作業時に問題が発生した場合のアラート連絡先は明確になっているか。

## サービスサイドとの調整
- リリース後、初動監視をどこまで実施するか、サービスサイドとの調整は完了しているか。

## 外部ベンダとの調整
- リリース作業を休日、深夜に実施する場合、事前に外部ベンダへの見積もり依頼を実施し、リリース当日の作業要員の手配調整が完了しているか。

## リリースアプローチ
- もっとも安全なリリースアプローチが検討されているか。

## リリース作業 全般その①
- リリース担当メンバが誰でも実施できる手順になっているか。（属人的な手順や表現になっている箇所はないか）

## リリース作業 全般その②
- リリース中にトラブルが発生したときの切り戻し（リリースバック）の判断タイミング、判断基準、判断者は明確になっているか。

## リリース作業 全般その③
- 切り戻し（リリースバック）手順は準備されているか。

## 事前バックアップ
- デプロイ開始前に資材のバックアップを取得する手順が盛り込まれているか。

## 関連ジョブ・プロセスの停止
- デプロイ開始前に停止が必要なジョブやプロセスがある場合、洗い出し・整理の上、手順に反映されているか。

## 監視の無効化
- プロセスの停止など、監視に引っかかるリリース作業を実施する場合、監視無効化の手順(もしくは、KCCSへの事前連絡)が盛り込まれているか。

## LB設定(作業前切り離し)
- リリース作業実施前に、リリース対象サーバーの切り離しを実施する手順が盛り込まれているか。

## 資材の削除
- リリースに伴い、不要になる資材については、影響分析の上、資源の削除、および、関連するジョブ(CRON)の削除についても考慮されているか。

## ジョブの追加・変更・削除その①
- 対象の実行ファイル(シェルなど)に対して、CRONから実行可能なパーミッションが設定されるよう、設定・確認が必要な対象ファイル、および、パーミッションの設定値が手順書に記載されているか。

## ジョブの追加・変更・削除その②
- 初回実行時の稼働確認方法が定義されているか。(初回稼働のタイミング、確認担当者、確認方法詳細)

## I/Fの追加・変更・削除その①
- 対向システムとの初回稼働タイミングについて認識合わせが完了しているか。また、初回稼働においてエラーが発生した場合の連絡方法についての取り決めは完了しているか。

## I/Fの追加・変更・削除その②
- ファイルI/Fの場合、以下に関する設定/確認手順が盛り込まれているか。

## データパッチ作業その①
- 事前バックアップの取得手順が手順に盛り込まれているか。

## データパッチ作業その②
- 実施タイミングは、オンライン時間帯、バッチ実行時間帯などを考慮した上で検討されているか。

## データパッチ作業その③
- データパッチ実施前後でのデータの比較確認作業が手順に盛り込まれているか。

## データ移行作業その①
- データ移行の実施タイミングは、オンライン時間帯、バッチ実行時間帯などを考慮した上で検討されているか。

## データ移行作業その②
- 既存テーブルにデータを移行する場合、事前バックアップの取得手順が盛り込まれているか。

## データ移行作業その③
- データ移行先の表領域の空き容量、データファイル格納ディスクの空き容量の確認が事前に完了しているか。

## データ移行作業その④
- 移行対象データの抽出タイミングは、締め時間などを考慮して定義されているか。

## データ移行作業その⑤
- 移行データのボリューム増に伴う、バッチ処理の処理時間、インデックスの作成要否などパフォーマンスに関する対応は考慮されているか。

## DBオブジェクトその①
- Tableを新規作成する場合、作成先の表領域の空き容量を確認が事前に完了しているか。

## DBオブジェクトその②
- 既存Tableの構成を変更する場合(項目の追加、項目名称・項目長の変更など)、IndexのステータスがInvalidになっているものがないかを確認し、InvalidになっているIndexについては、再作成を実施する手順が盛り込まれているか。

## 環境依存オブジェクトその①
- 設定ファイルなどの環境依存オブジェクトのリリースがある場合、他環境の設定ファイルがそのまま商用環境に上書かれない手順になっているか。(各種設定ファイル、CSS、Imageファイルの参照先を含むソースコードなど)

## 環境依存オブジェクトその②
- 最新の設定内容を反映するためにサーバーやサービスの再起動などが必要な場合、その手順が盛り込まれているか。

## 監視設定その①
- 必要な監視項目について、監視基準書への記入とKCCS/CMへの連絡は完了しているか。

## 監視設定その②
- 上記の監視設定に引っかかった場合、きちんとアラートメールが送信されることが確認できているか。

## デプロイ作業・リリースオブジェクト別その①
- ユーザー別に表示内容が異なる画面など、画面ごとにキャッシュの設定が正しく実施されているか(設計のタイミングで定義した設定どおりに設定されているか)を確認する手順が盛り込まれていること。

## デプロイ作業・リリースオブジェクト別その②
- ロボット対策が必要なURLの場合、「robot.txt」を配置する手順が盛り込まれているか。(※検索エンジンのクローラーに拾われないようにするための対策が必要な場合のみ)

## デプロイ作業・リリースオブジェクト別その③
- 不要なBASIC認証(.htaccess)が残っていないかを確認する手順が盛り込まれているか。

## デプロイ作業・リリースオブジェクト別その④
- JavaScriptがminifyされていること。

## デプロイ作業・リリースオブジェクト別その⑤
- 端末側の古いキャッシュが悪さをして、リリース直後に画像やAPIまわりでの不具合が想定される案件の場合、左記を回避するためのリリース手順が検討されているか。

## デプロイ作業・リリースオブジェクト別その⑥
- リリース後に手動で実行が必要なバッチ処理がある場合(コンテンツ反映バッチなど)、その手順が盛り込まれているか。(※バッチの実行スケジュールとリリース作業の時間制約を整理しておくこと)

## デプロイ作業・リリースオブジェクト別その⑦
- 商用とSTG間の環境やデータの差異によりテストやリリース時に留意すべき事項があれば確認すること。

## デプロイ作業・リリースオブジェクト別その⑧
- セキュリティルームからのみのサービス運用を想定している場合、Firewallの設定など、リリース時に必要な作業が手順に盛り込まれているか。

## 関連ジョブ・プロセスの再開
- リリース作業に伴い、停止したプロセスやジョブの再起動や再開手順が盛り込まれているか。

## ジョブ(CRON)の実行スケジュール(起動間隔)
- 実行スケジュール(起動間隔)が商用向けスケジュールになっていること。※起動間隔が検証用のままになっていないか

## LB設定(作業後切り戻し)
- リリース作業実施前に切り離したLBの設定を元に戻す(切り離しの解除)手順が盛り込まれているか。

## リリース漏れサーバーのチェック
- リリース対象のサーバーが複数ある場合、全サーバーへのリリース作業が完了していることを最終確認する手順が盛り込まれているか。

## 処理制御フラグ(バッチ稼働フラグなど)の戻し
- リリース作業に伴い、バッチ稼働フラグなどの処理制御系のフラグやマスタを一時的に更新する場合(一時的にフラグを外したりする場合)、リリース作業終了後に、もとの設定に戻す手順が盛り込まれているか。

## 監視の有効化
- リリース作業に伴い、無効化する監視項目がある場合、リリース作業終了後に監視を有効化する手順(もしくは、KCCSへのリリース作業完了連絡)が盛り込まれているか。
