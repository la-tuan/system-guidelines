# システム運用ガイドライン

## はじめに
このガイドラインでは、medibaにおける、システム運用についてのガイドラインを下記の大項目に分け、それぞれ定めます。

## 用語の定義
* 運用

 システム維持を行なう定常業務をいう。
* 保守

 システム復旧及びシステム更新作業
* ユーザー

 サービス及びシステム利用者をいう。

## 1. ガイドラインの基本的な考え方
### 1.1　目的
本ガイドラインは、システムにおける運用及び保守業務を円滑に行なうためを目的とするものである。

### 1.2.　適用範囲
システム運用及び保守業務に関与する業務に適用する。

### 1.3.　本ガイドラインの管理
 1. 本ガイドラインの管理は運用・保守部署とする。
 1. 本ガイドラインは、見直しが必要と判断された場合は、適宜見直しを行なうものとする。
 1. 本ガイドラインは、社内から閲覧できる箇所に掲載する。

## 2. 構成管理・保守に関する要件
### 2.1. アカウント管理
セキュリティを考慮したサーバのアカウント管理を行なう、
*	1人1アカウントとし、アカウントの共有は行なわないこと
*	未使用アカウントは直ちに削除すること(退職者など)
*	定期的にパスワードを変更すること
*	必要な権限のみ付与すること
*	運用・保守部署でアカウント管理を行なうこと
*	発行アカウントは一元管理を行なうこと
*	バッチ処理の実行アカウント等はドキュメント化して残しておくこと

### 2.2. サーバー保守

#### 2.2.1. 監視
早期に障害発見を行ない、適切な障害対応を行えるようにすること
* 以下の監視を行ない障害の検知ができるようにすること
 -	サーバ、NW 機器システム状況(ping,ヘルスチェック, リソース使用量など)
 -	プロセス稼動状況
 -	バッチ成功有無
 -	各種ログ
*	監視項目がダウンした場合、アラートを出すこと
*	障害に対するメッセージを決定すること

#### 2.2.2. バックアップ
障害時のシステム復旧及び調査に必要なデータのバックアップを行ないデータ消失を防ぐ。
* 障害及び調査に必要なバックアップ対象となるデータを精査すること
 * 障害復旧
   * データベース
   * 情報ファイル
   * 設定ファイル
   * ソースコード
 * 調査
   * アクセスログ
   * 操作ログ
 * その他
   * ドキュメントなど
* データの特性によりバックアップ方式を決定すること
 * 時間
   * リアルタイム
   * 定常(時、日、週など)
 * 方式
   * 全データ、差分など
* システムの特性によりデータの保存期間を決めること
* システムの特性によりバックアップの有無を決めること
* 保管先は、バックアップ元と同居させないこと
* 保管先の障害対応性も検討すること
* バックアップの方針についてレビューすること


#### 2.2.3. ログ
各種ログの管理を必ず行なう。[ガイドライン](https://github.com/mediba-system/system-guidelines/blob/master/AppLogGuideline.md)に準拠すること。

#### 2.2.4. SLA
受託サービスや、プレーヤーが多岐に渡る場合、運用及び保守業務の責任分担を明確にするため、サービスレベル契約（Service Level Agreement；ＳＬＡ）の導入を検討すること
* SLA を締結する場合、必要な項目が記載されているかを確認すること
 * SLA の項目が適切であること
   * サーバーの稼働率
   * アプリケーションの稼働率
   * 基準応答時間達成率 など
 * SLA が守れたか月次ベースでチェックすること
 * SLA 違反の改善を検討すること


### 2.3. クライアント端末
運用及び保守業務にクライアント端末を用いる場合は、以下の観点で管理する。

* メンテナンス要件によって決められた端末からのみ作業を実施すること  
* 各システムのメンテナンス要件は有識者のレビューを通して策定すること  
* 運用・保守部署は使用する端末がその要件を満たしていることを確認すること  
* 使用する端末の安全性を確保する為の情報について管理すること  
 + 使用する端末は一元管理すること  
 + 不要なソフトウェアをインストールしないこと  
 + アンチウィルスソフト等のマルウェア対策を実装すること  
 + 規定の場所・方法以外でネットワークに接続しないこと  


### 2.4. 媒体の管理  
原則として外部媒体の接続は禁止とする。
ただし、業務上必要な場合は必ず管理・責任者の許可を得た上で使用する。  
使用する媒体は以下に沿って管理する。  

* 使用する媒体は運用・保守部署にて一元管理し、使用履歴を記録すること  
* 接続の事前にウィルスなどが含まれていないことを確認すること  
* 利用時以外はデータを保存しないこと  
* 媒体は施錠可能な場所で保管すること  
* 媒体の廃棄の際はデータを完全に削除した上で廃棄すること


### 2.5. LAN 接続
各システムは運用及び保守業務が可能な管理用接続の方法を有するものとする。
また、システム構成・接続方式を検討する際は以下の点を考慮する。

* 定められた場所・方法以外から管理用接続できないこと
* 運用・保守担当者以外が管理用接続できないこと
* 管理用接続の高負荷や障害等により、ユーザー通信に影響を与えないこと


## 3. 脆弱性への対応
### 3.1. 脆弱性管理
システムを構成するOS及びソフトウェアの脆弱性情報や、その他システムの脅威となりうる事象またはその要素
(以下、セキュリティインシデントと表記する）について運用・保守部署にて管理・対応する。

#### 3.1.1. セキュリティインシデントの定義
本ガイドラインでは、以下の被害が発生する事象やその「疑いのある要素」についても含め
セキュリティインシデントと定義する。

* データの破壊、改ざん、流出（盗聴、情報の不正持ち出しなど）
* コンピュータ資源の盗用（システムの不正利用など）
* サービスの妨害（サーバーへの攻撃など）

#### 3.1.2. セキュリティインシデントの管理

* セキュリティインシデントについての管理体制、対応体制及び連絡体制を明確にしておくこと
* それぞれの体制について、インシデントの発覚状況に応じた体制を確立し、発覚した場合はそれぞれ
  あらかじめ決められた対応体制及び連絡体制に沿って速やかに対処できるよう準備すること
 * 新たな脆弱性情報について速やかに内容を確認し、各部門へ脆弱性対象の使用有無、パッチの適用状況を確認する
 * 脆弱性攻撃などの疑いが発覚した段階でインシデントと判断し、速やかに報告・調査を実施する
 * 利用ユーザー環境でのインシデント発生時は速やかに運用・保守部署及び関連部署に連絡する
* 各インシデント及びその対応内容について記録を残すこと
	- 発生日
	- 詳細内容
	- 対象機器
	- 対処方針
	- 判断理由
	- 判断責任者
	- 対処完了日

#### 3.1.3. サーバーの脆弱性対処

* システム影響を考慮し原則として常時最新化はしない
* パッチ適用が必要な場合は十分な検証の上実施する

#### 3.1.4. クライアントの脆弱性対処
* パッチ配信サーバにて適用するセキュリティパッチを管理すること
* アンチウィルスソフト等のマルウェア対策を実装すること

### 3.2. リリース
保守業務において以下の理由でシステムへの変更が必要な場合は各システムの方針に基づいてリリース作業を実施する。

* サービスへの機能追加が必要な場合
* システムに脆弱性が見つかった場合
* その他サービス改善の為に運用保守部署にて変更が必要と判断した場合

作業を行なう際はそのリスクに応じて以下に観点に基づいて実施する。
* 発生する作業影響を事前に明確にすること
* 作業フロー中の危険ポイントを整理しておくこと
* 異常が発生した場合の切り戻し手段を用意すること
* リリース作業時は作業者と確認者の複数名で実施すること
* 作業証跡(作業ログ、画面キャプチャ等)を取得・保管すること
* 実施日時、実施者、変更履歴、実施結果を保管すること
* リリース後には問題点や作業効率化を検討すること


### 3.3. 障害対応
障害が発生した場合は原則としてサービス復旧を最優先とし、迅速な対応を行なう。
また、迅速な対応を可能とするため、事前に以下について準備する。

* 対応体制及び連絡体制を明確にしておくこと  
* 各障害箇所に対し、影響範囲を把握しておくこと  
* 各障害箇所に対し、復旧作業手順を用意しておくこと  
* 障害復旧後、再発防止策を検討すること  

### 3.4. 外部委託
作業品質や業務効率を考慮し、外部委託が望ましいと判断された場合は、
情報漏えいや不正な行為が発生しないよう情報の取り扱いを情報セキュリティ委員に相談し、
許諾を得た上で実施する。

#### 3.4.1. 委託内容の明確化
業務を委託する際は以下について明確にし、社内の同意を得た上で、委託先と合意を結ぶ。
委託先との合意は書面として記録を残し、契約の曖昧化を防止する。

* 委託業務内容（責任分界点）
* 委託元、委託先の管理・責任者及び体制  
* 作業場所（接続方式）  

#### 3.4.2. 委託業務の管理
委託業務以外の行為を防止する為、以下について業務内容とそのリスクに応じて
必要最低限となるよう検討し、管理する。

* 入室可能範囲/入退室履歴
* 利用アカウント権限/作業履歴
